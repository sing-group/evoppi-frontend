<mat-card>
<form [formGroup]="formSameSpecies" (change)="onChangeForm()">
  <mat-form-field class="width-100">
    <mat-select placeholder="Species" (change)="onChangeSpecies($event.value)" formControlName="species">
      <mat-option *ngFor="let specie of species" [value]="specie">
        {{ specie.name }}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <mat-form-field class="width-50">
    <mat-select placeholder="Reference Interactome" formControlName="interactomeA" (selectionChange)="onSelectInteractomeA($event.value)">
      <mat-option *ngFor="let interactome of interactomesA" [value]="interactome">
        {{ interactome.name }}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <mat-form-field class="width-50 right">
    <mat-select placeholder="Target Interactome" formControlName="interactomeB" (selectionChange)="onSelectInteractomeB($event.value)">
      <mat-option *ngFor="let interactome of interactomesB" [value]="interactome">
        {{ interactome.name }}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <mat-form-field class="width-100">
    <mat-label>Genes</mat-label>
    <input #searchInput type="search" matInput placeholder="Start typing something to search genes"
           formControlName="gene"
           autocomplete="off"
           [value]="genesInput" />
  </mat-form-field>
  <mat-accordion>
    <app-autocomplete *ngFor="let gene of genes" [title]="gene.geneId" [names]="gene.names" (radioSelected)="onGeneSelected($event)">
    </app-autocomplete>
  </mat-accordion>
  <mat-form-field class="width-25">
    <input type="number" matInput placeholder="Interaction level" formControlName="level" [(ngModel)]="level">
  </mat-form-field>
  <mat-slider thumbLabel tickInterval="1" [min]="1" [max]="3" [(ngModel)]="level" formControlName="level" class="width-75 right"></mat-slider>

  <button mat-raised-button color="primary" (click)="onCompare()" [disabled]="formSameSpecies.status === 'INVALID'">Compare</button>
  <a mat-raised-button color="primary" [href]="csvContent" [download]="csvName" *ngIf="csvContent !== ''">Export CSV</a>
  <!--a mat-raised-button color="primary" [href]="resultUrl + '/interactome/' + formSameSpecies.value.interactomeA.id + '/fasta'"
     [download]="formSameSpecies.value.interactomeA.name" *ngIf="csvContent !== ''">
    Export Fasta of {{formSameSpecies.value.interactomeA.name}}
  </a-->
  <a mat-raised-button color="primary" [href]="resultUrl + '/interactome/' + formSameSpecies.value.interactomeA.id + '/fasta'"
     target="_blank" *ngIf="csvContent !== ''">
    Export Fasta {{formSameSpecies.value.species.name}}-{{formSameSpecies.value.interactomeA.name}}
  </a>
  <a mat-raised-button color="primary" [href]="resultUrl + '/interactome/' + formSameSpecies.value.interactomeB.id + '/fasta'"
     target="_blank" *ngIf="csvContent !== ''">
    Export Fasta {{formSameSpecies.value.species.name}}-{{formSameSpecies.value.interactomeB.name}}
  </a>
  <mat-card *ngIf="!hideTable">
    <mat-tab-group>
      <mat-tab label="Table view">
        <mat-table matSort #table [dataSource]="dataSource" class="table-same-species" appAfterViewInit (afterViewInit)="initTable()">
          <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
          <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
          <ng-container matColumnDef="GeneA">
            <mat-header-cell *matHeaderCellDef mat-sort-header>Gene A</mat-header-cell>
            <mat-cell *matCellDef="let row">
              <button mat-mini-fab (click)="onClickGene(row.geneA)" class="node1">{{row.geneA}}</button>
            </mat-cell>
          </ng-container>
          <ng-container matColumnDef="GeneB">
            <mat-header-cell *matHeaderCellDef mat-sort-header>Gene B</mat-header-cell>
            <mat-cell *matCellDef="let row">
              <button mat-mini-fab (click)="onClickGene(row.geneB)" class="node1">{{row.geneB}}</button>
            </mat-cell>
          </ng-container>
          <ng-container matColumnDef="Interactomes">
            <mat-header-cell *matHeaderCellDef mat-sort-header>Interactomes</mat-header-cell>
            <mat-cell *matCellDef="let row">
              <mat-chip-list>
                <mat-chip *ngFor="let interactome of row.interactomes"
                          ngClass="{{interactome === referenceInteractome.id ? 'link1' : 'link2'}}">
                  {{interactome === referenceInteractome.id ? referenceInteractome.name: targetInteractome.name}}
                </mat-chip>
              </mat-chip-list>
            </mat-cell>
          </ng-container>
          <ng-container matColumnDef="Degree">
            <mat-header-cell *matHeaderCellDef mat-sort-header>Degree</mat-header-cell>
            <mat-cell *matCellDef="let row">{{row.degree}}</mat-cell>
          </ng-container>
        </mat-table>
      </mat-tab>
      <mat-tab label="Graph view">
        <app-graph [nodes]="nodes" [links]="links" [graphWidth]="graphWidth" [graphHeight]="graphHeight"></app-graph>
        <app-legend-same-species [graphWidth]="graphWidth" [graphHeight]="graphHeight"></app-legend-same-species>
      </mat-tab>
    </mat-tab-group>
  </mat-card>
</form>
</mat-card>
